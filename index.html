<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Voting App - Fantasanremo Style</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #FFD400, #001F54);
            color: #000000;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #001F54;
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        /* New Login Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .login-box {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 300px;
        }
        .login-box h2 {
            text-align: center;
            margin-bottom: 20px;
        }
        .login-box label {
            display: block;
            margin-bottom: 5px;
            color: #001F54;
        }
        .login-box input {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #001F54;
            border-radius: 5px;
        }
        .login-box button {
            width: 100%;
            padding: 10px;
            background-color: #001F54;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .login-box button:hover {
            background-color: #002F7A;
        }
        .error {
            color: red;
            text-align: center;
        }
        /* Existing styles */
        .character {
            border: 2px solid #FFD400;
            border-radius: 10px;
            padding: 20px;
            margin: 15px;
            background-color: #F2F2F2;
            box-shadow: 2px 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
        }
        /* ...rest of the existing CSS... */
    </style>
</head>
<body>
    <header>
        <h1>Fantasanremo Voting App</h1>
    </header>

    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <h2>Login</h2>
            <div class="error" id="errorMessage"></div>
            <label for="username">Username</label>
            <input type="text" id="username" placeholder="Enter Username">
            <label for="password">Password</label>
            <input type="password" id="password" placeholder="Enter Password">
            <button onclick="login()">Login</button>
        </div>
    </div>

    <div id="characters" style="display: none;">
        <!-- Characters will be dynamically loaded here -->
    </div>

    <div class="results" style="display: none;">
        <h2>Results</h2>
        <div id="results">
            <!-- Results will be displayed here -->
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Fantasanremo Voting App. All rights reserved.</p>
    </footer>

    <script>
        // Array of users with their usernames and passwords
        const users = [
            { username: "Presidente_Indolfi", password: "password123" },
            { username: "Copresidente_M", password: "password456" },
            { username: "Copresidente_A", password: "admin123" }
        ];

        let currentUser = null;

        function login() {
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;
            const errorMessage = document.getElementById("errorMessage");

            // Check if the username and password match any user
            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                // Store the logged in user and hide the login form
                currentUser = user;
                document.getElementById("loginContainer").style.display = "none";
                document.getElementById("characters").style.display = "block";
                document.querySelector(".results").style.display = "block";
                loadFromLocalStorage();
                renderCharacters();
                renderResults();
            } else {
                // Show error message if login fails
                errorMessage.innerHTML = "Incorrect username or password.";
            }
        }

        // List of characters and voting logic (unchanged)
        const characters = [
            "Achille Lauro", "Bresh", "Brunori SAS", "Clara", "Coma_Cose",
            "Elodie", "Emis Killa", "Fedez", "Francesca Michielin", "Francesco Gabbani",
            "Gaia", "Giorgia", "Irama", "Joan Thiele", "Lucio Corsi",
            "Marcella Bella", "Massimo Ranieri", "Modà", "Noemi", "Olly",
            "Rkomi", "Rocco Hunt", "Rose Villain", "Sarah Toscano", "Serena Brancale",
            "Shablo ft. Guè, Joshua e Tormento", "Simone Cristicchi", "The Kolors", "Tony Effe", "Willie Peyote"
        ].sort();

        const categories = ["Canzone", "Esibizione", "Outfit"];
        let characterData = characters.map(name => ({
            name,
            image: "https://picsum.photos/seed/" + name.replace(/\s+/g, "") + "/100",
            votes: { Canzone: 0, Esibizione: 0, Outfit: 0 }
        }));

        function renderCharacters() {
            const characterContainer = document.getElementById("characters");
            characterContainer.innerHTML = "";

            characterData.forEach((character, index) => {
                const characterDiv = document.createElement("div");
                characterDiv.className = "character";
                characterDiv.innerHTML = `
                    <img src="${character.image}" alt="${character.name}">
                    <div>
                        <h3>${character.name}</h3>
                        <div class="votes">
                            ${categories
                                .map(
                                    (category) => `
                                    <label for="vote-${index}-${category}">${category}:</label>
                                    <input type="number" id="vote-${index}-${category}" 
                                           aria-label="Vote for ${character.name}'s ${category}" 
                                           min="0" max="10" value="${character.votes[category]}" 
                                           onchange="updateVote(${index}, '${category}', this.value)" />
                                `
                                )
                                .join("")}
                        </div>
                    </div>
                `;
                characterContainer.appendChild(characterDiv);
            });
        }

        function updateVote(index, category, value) {
            const input = document.getElementById(`vote-${index}-${category}`);
            const numericValue = Math.max(0, Math.min(10, parseInt(value) || 0));

            if (value < 0 || value > 10) {
                input.classList.add("invalid");
            } else {
                input.classList.remove("invalid");
                characterData[index].votes[category] = numericValue;
                saveToLocalStorage();
                renderResults();
            }
        }

        function renderResults() {
            const resultsContainer = document.getElementById("results");
            resultsContainer.innerHTML = "";

            characterData.sort((a, b) => {
                const totalA = categories.reduce((sum, cat) => sum + a.votes[cat], 0);
                const totalB = categories.reduce((sum, cat) => sum + b.votes[cat], 0);
                return totalB - totalA;
            });

            characterData.forEach((character) => {
                const totalVotes = categories.reduce((sum, cat) => sum + character.votes[cat], 0);
                const resultDiv = document.createElement("div");
                resultDiv.innerHTML = `
                    <h4>${character.name}</h4>
                    <ul>
                        ${categories
                            .map(
                                (category) => `
                                <li>${category}: ${character.votes[category]}</li>
                            `
                            )
                            .join("")}
                    </ul>
                    <p><strong>Total Votes: ${totalVotes}</strong></p>
                `;
                resultsContainer.appendChild(resultDiv);
            });
        }

        function saveToLocalStorage() {
            localStorage.setItem("characterVotes", JSON.stringify(characterData));
        }

        function loadFromLocalStorage() {
            const savedData = localStorage.getItem("characterVotes");
            if (savedData) {
                characterData = JSON.parse(savedData);
            }
        }

        window.addEventListener("beforeunload", saveToLocalStorage);
    </script>
</body>
</html>
